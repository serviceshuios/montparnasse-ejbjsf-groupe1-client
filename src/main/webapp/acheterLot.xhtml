<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<meta charset="UTF-8" />
	<title>Acheter un lot</title>
	<h:outputStylesheet library="css" name="bootstrap.css" />
</h:head>
<body>
	<div class="container">

		<h:form>
			
			<h2>Personnes</h2>
			<h:panelGrid columns="2" cellpadding="5">
				<h:outputLabel value="Personnes disponbles" />
				<h:selectOneMenu id="personne" value="#{personneBean.personne.idPersonne}">
					<f:selectItem itemValue="null" itemLabel="Choisissez une personne" />
					<f:selectItems value="#{personneBean.listerPersonnes()}" var="p" 
					itemValue="#{p.idPersonne}" itemLabel="#{p.nom}, #{p.prenom}" />
				</h:selectOneMenu>
			</h:panelGrid>
			<h2>Achat d'un lotissement</h2>
			<h:panelGrid columns="2" cellpadding="5">
				<h:outputLabel value="Lotissements disponibles" />
				<h:selectOneMenu id="lotissement" value="#{lotissementBean.lotissement.idLot}">
					<f:selectItem itemValue="null" itemLabel="Choisissez un lot" />
					<f:selectItems value="#{lotissementBean.listerLotissements()}" var="p" 
					itemValue="#{p.idLot}" itemLabel="#{p.numLot}, #{p.adresseLot}, #{p.dateCreation}, #{p.prix}" />
				</h:selectOneMenu>
			</h:panelGrid>

			<h:commandButton action="#{lotissementBean.acheterLotissement(lotissement.personne.idPersonne, lotissement.idLot)}" value="acheter">
				<f:setPropertyActionListener
								target="#{lotissementBean.personne.idPersonne}"
								value="#{personneBean.personne.idPersonne}"></f:setPropertyActionListener>
			</h:commandButton>


			<div>
				<h2>Liste des personnes</h2>
				<h:dataTable value="#{personneBean.listerPersonnes()}" var="p"
					border="1" class="table table-striped">
					<h:column>
						<f:facet name="header">ID</f:facet>
						<h:outputText value="#{p.idPersonne}" />
					</h:column>
					<h:column>
						<f:facet name="header">NOM</f:facet>
						<h:outputText value="#{p.nom}" />
					</h:column>
					<h:column>
						<f:facet name="header">PRENOM</f:facet>
						<h:outputText value="#{p.prenom}" />
					</h:column>
					<h:column>
						<f:facet name="header">Age</f:facet>
						<h:outputText value="#{p.age}" />
					</h:column>
					
				</h:dataTable>
			</div>
		</h:form>
	</div>
	
</body>
</html>